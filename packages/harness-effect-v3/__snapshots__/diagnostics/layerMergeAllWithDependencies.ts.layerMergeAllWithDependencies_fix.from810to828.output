// code fix layerMergeAllWithDependencies_fix  output for range 810 - 828
import { Effect, Layer } from "effect"

export class DbConnection extends Effect.Service<DbConnection>()("DbConnection", {
  succeed: {}
}) {}
export class FileSystem extends Effect.Service<FileSystem>()("FileSystem", {
  succeed: {}
}) {}
export class Cache extends Effect.Service<Cache>()("Cache", {
  effect: Effect.as(FileSystem, {})
}) {}
export class UserRepository extends Effect.Service<UserRepository>()("UserRepository", {
  effect: Effect.as(Effect.zipRight(DbConnection, Cache), {})
}) {}

const cachePassthrough = Layer.effect(Cache, Cache)

export const shouldNotWarn = Layer.mergeAll(
  DbConnection.Default,
  FileSystem.Default
)

export const shouldNotWarn2 = Layer.mergeAll(
  UserRepository.Default,
  cachePassthrough
)

export const shouldWarn = Layer.mergeAll(
  DbConnection.Default,
  Cache.Default // <- this requires a DbConnection
).pipe(Layer.provideMerge(FileSystem.Default))

export const shouldWarn2 = Layer.mergeAll(
  DbConnection.Default,
  FileSystem.Default,
  Cache.Default, // <- this requires a FileSystem,
  UserRepository.Default // <- this requires a DbConnection
)
